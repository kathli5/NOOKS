<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>Node Starter</title>
    <!-- load local stylesheet (css) -->
    <link rel="stylesheet" href="/styles.css" />
    <!-- loading jquery -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <%- include("partials/imports.ejs") %>
</head>

<body>
    <%- include("partials/navbar.ejs") %>

    <section class="pagebody">
        <h1>Edit my review for <%= nook.name %></h1>

        <form id="review_form" method="POST" action="/edit/<%= nook.nid %>/<%= review.rid %>">
            <label for="nookRating" class="form-label">Rating</label>
            <input type="range" name="nookRating" id="nookRating" class="form-range" min="0" max="5" step="1"
                list="steplist" value='<%=review.rating%>' required />
            <datalist id="steplist">
                <option>0</option>
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
            </datalist>

            <br>
            <p>Tags</p>
            <div class="form-check form-switch">
                <% if (review.tags.includes('Wi-fi available')) {%>
                <input class="form-check-input" type="checkbox" role="switch" value="wifi" id="wifi-check"
                name="wifiCheck" checked>
                <% } else { %>
                <input class="form-check-input" type="checkbox" role="switch" value="wifi" id="wifi-check"
                name="wifiCheck">
                <% } %>
                <label class="form-check-label" for="wifi-check">
                    Wi-Fi Available?
                </label>
            </div>
            <div class="form-check form-switch">
                <% if (review.tags.includes('Outlet available')) {%>
                <input class="form-check-input" type="checkbox" role="switch" value="outlet" id="outlet-check"
                name="outletCheck" checked>
                <% } else { %>
                <input class="form-check-input" type="checkbox" role="switch" value="outlet" id="outlet-check"
                    name="outletCheck">
                    <% } %>
                <label class="form-check-label" for="outlet-check">
                    Outlet Available?
                </label>
            </div>
            <div class="form-check form-switch">
                <% if (review.tags.includes('Food available')) {%>
                <input class="form-check-input" type="checkbox" role="switch" value="outlet" id="food-check"
                name="foodCheck" checked>
                <% } else { %>
                <input class="form-check-input" type="checkbox" role="switch" value="outlet" id="food-check"
                name="foodCheck">
                <% } %>
                <label class="form-check-label" for="outlet-check">
                    Food Available?
                </label>
            </div>

            <br>
            <p>Noise Level</p>
            <% if (review.tags.includes('quiet')) {%>
            <input type="radio" id="quiet" name="noise" value="quiet" required checked>
            <% } else { %>
            <input type="radio" id="quiet" name="noise" value="quiet" required>
            <% } %>
            <label for="quiet">Usually Quiet</label><br>
            <% if (review.tags.includes('loud')) {%>
            <input type="radio" id="loud" name="noise" value="loud" required checked>
            <% } else { %>
            <input type="radio" id="loud" name="noise" value="loud">
            <% } %>
            <label for="loud">Potentially Loud</label><br>

            <br>
            <fieldset>
                <p>Edit Review</p>
                <textarea id="text" name="text" class="form-control"
                    placeholder="Add Review Here" rows="3" cols="40"><%=review.text%></textarea>
            </fieldset>

            <br>
            <p> Photos: </p>
            <% if (review.photo) { %>
                <img class="nook_photos" src="<%= review.photo %>" alt="Photo of <%= nook.name %>"/>
            <%}%>
            <p><button type="submit" class="btn btn-primary mt-3 form-control">Update Review</button></p>
        </form>

        <form method="POST" action="/delete/<%= nook.nid %>/<%= review.rid %>">
            <p><button id="delete" type="submit" class="btn btn-primary mt-3 form-control">Delete Review</button></p>
        </form>
    </section>
    
    <!-- load local js -->
    <script> 

    $("#delete").click(function (event) {
        let result = confirm("This will delete your review - are you sure?\nClick OK to continue");
        if (!result) {
            event.preventDefault();
        }
    })


    </script>

</body>

</html>